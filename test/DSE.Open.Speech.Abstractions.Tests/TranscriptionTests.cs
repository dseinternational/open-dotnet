// Copyright (c) Down Syndrome Education International and Contributors. All Rights Reserved.
// Down Syndrome Education International and Contributors licence this file to you under the MIT license.

using System.Collections.Immutable;

namespace DSE.Open.Speech.Abstractions.Tests;

public class TranscriptionTests
{
    public TranscriptionTests(ITestOutputHelper output)
    {
        Output = output;
    }

    public ITestOutputHelper Output { get; }

    [Theory]
    [InlineData("/kloʊz/")]
    [InlineData("/kloʊs/")]
    [InlineData("/ˈɛərəpleɪn/")]
    [InlineData("/prəˈvaɪd/")]
    [InlineData("/ˈzaɪləfoʊn/")]
    [InlineData("/ˈzɛbrə/")]
    [InlineData("/ʃɛər/")]
    [InlineData("/tʃɛər/")]
    public void CanCreateAndFormat(string example)
    {
        var original = new Transcription(example);
        var formatted = original.ToString();
        Assert.Equal(example, formatted);
    }

    [Theory]
    [InlineData("kloʊz/")]
    [InlineData("/kloʊs")]
    [InlineData("/x-ray/")]
    [InlineData("[prəˈvaɪd")]
    [InlineData("")]
    [InlineData(" ")]
    [InlineData("/ /")]
    [InlineData("//")]
    public void InvalidTranscriptionsThrowOnParse(string example)
    {
        _ = Assert.Throws<FormatException>(() => Transcription.Parse(example, CultureInfo.InvariantCulture));
    }

    [Theory]
    [MemberData(nameof(WordTranscriptions))]
    public void CanCreateWordTranscriptions(string example)
    {
        var original = new Transcription(example);
        var formatted = original.ToString();
        Assert.Equal(example, formatted);
    }

    [Fact]
    public void OutputCharCodes()
    {
        var codes = SpeechSound.Alphabet.Select(c => (int)c).Distinct().OrderBy(c => c).ToArray();
        foreach (var c in codes)
        {
            Output.WriteLine($"{c:x}");
        }
    }

    public static TheoryData<string> WordTranscriptions => new(s_wordTranscriptions.Select(t => $"[{t}]").ToArray());

    private static readonly ImmutableArray<string> s_wordTranscriptions =
    [
"ˈɑːm",
        "ˈænəməɫ",
        "ˈænəməɫz",
        "ˈæpə‍l",
        "ˈæpəɫ",
        "ˈæpə‍lz",
        "ˈæpəɫz",
        "ˈɒf",
        "ˈaɪ",
        "ˈaɪz",
        "ˈɒn",
        "ˈɑn",
        "ˈɔn",
        "ˈɑɹm",
        "ˈaʊɫ",
        "ˈaʊɫz",
        "ˈaʊt",
        "ˈaʊtˈsaɪd",
        "bˈɑːθ",
        "bˈæɡ",
        "ˈbæɡ",
        "ˈbæθ",
        "ˈbæˌθɹum",
        "bˈa‍ɪsɪkə‍l",
        "ˈbaɪsɪkəɫ",
        "ˈbaɪt",
        "ˈbɑks",
        "bɐnˈɑːnɐ",
        "bɐnˈɑːnəz",
        "bˈɒtə‍l",
        "ˈbɑtəɫ",
        "bˈɔːl",
        "bˈɔːlz",
        "ˈbɔɫ",
        "ˈbɔɫz",
        "bˈɜːd",
        "ˈbəbəɫ",
        "ˈbəbəɫz",
        "bˈɛd",
        "ˈbɛd",
        "ˈbɝd",
        "bˈɛdɹuːm",
        "ˈbɛˌdɹum",
        "bˈe‍ə",
        "bˈe‍əz",
        "bˈe‍ɪbi",
        "ˈbeɪbi",
        "bəlˈuːn",
        "bəlˈuːnz",
        "bəˈɫun",
        "bəˈɫunz",
        "bəˈnænə",
        "bəˈnænəz",
        "ˈbɛɹ",
        "ˈbɛɹz",
        "ˈbəs",
        "ˈbətɝˌfɫaɪ",
        "bˈə‍ʊl",
        "bˈə‍ʊt",
        "ˈbi",
        "bˈiː",
        "ˈbɪb",
        "bˈɪn",
        "ˈbɪn",
        "ˈbɪskət",
        "ˈbɪskəts",
        "bˈɪskɪt",
        "bˈɪskɪts",
        "ˈbɫæŋkət",
        "ˈbɫæŋkɪt",
        "blˈæŋkɪt",
        "ˈbɫɑk",
        "ˈbɫɑks",
        "ˈbɫoʊ",
        "ˈbɫoʊɪŋ",
        "ˈboʊɫ",
        "ˈboʊt",
        "bɹˈɛd",
        "ˈbɹɛd",
        "bɹˈɛkfəst",
        "ˈbɹɛkfəst",
        "ˈbɹəʃ",
        "ˈbɹəʃɪŋ",
        "bɹˈɪk",
        "ˈbɹɪk",
        "ˈbɹɪŋ",
        "ˈbɹɪŋɪŋ",
        "ˈbɹum",
        "bɹˈʌʃ",
        "bɹˈʌʃɪŋ",
        "bˈuːt",
        "bˈuːts",
        "bˈʊk",
        "ˈbʊk",
        "bˈʊks",
        "ˈbʊks",
        "ˈbut",
        "ˈbuts",
        "bˈʌbə‍l",
        "bˈʌbə‍lz",
        "bˈʌs",
        "ˈɔf",
        "dˈɑːns",
        "dˈædi",
        "ˈdædi",
        "ˈdæns",
        "dˈɒɡ",
        "dˈɒɡz",
        "ˈdɑɡz",
        "ˈdɔɡz",
        "ˈdaɪpɝ",
        "dˈɒl",
        "ˈdɑɫ",
        "dˈa‍ʊn",
        "ˈdaʊn",
        "dˈɔː",
        "ˈdɔɡ",
        "ˈdɔɹ",
        "dˈɜːti",
        "ˈdək",
        "ˈdəks",
        "ˈdɝti",
        "dˈɪnɐ",
        "ˈdɪnɝ",
        "ˈdɹɔ",
        "ˈdɹɔɪŋ",
        "dɹˈɪŋk",
        "ˈdɹɪŋk",
        "dɹˈɪŋkɪŋ",
        "ˈdɹɪŋkɪŋ",
        "dˈʌk",
        "dˈʌks",
        "ˈdʒækət",
        "ˈdʒækɪt",
        "ˈdʒəmp",
        "ˈdʒəmpɪŋ",
        "ˈdʒɛnəɫ",
        "ˈdʒɛntəɫ",
        "d‍ʒˈɛntə‍l",
        "d‍ʒˈuːs",
        "ˈdʒus",
        "ˈe‍əɹəplˌe‍ɪn",
        "ˈɛɡ",
        "ˈɛɡz",
        "ˈɛɫəfənt",
        "ˈɛɫəfənts",
        "ˈɛlɪfənt",
        "ˈɛlɪfənts",
        "ˈəndɝ",
        "ˈəndɝˌwɛɹ",
        "ˈəp",
        "ˈɛɹˌpɫeɪn",
        "ˈə‍ʊpən",
        "ˈə‍ʊpənɪŋ",
        "ˈfɑɫ",
        "ˈfɔɫ",
        "ˈfɑɫɪŋ",
        "ˈfɔɹk",
        "fˈe‍ɪs",
        "ˈfeɪs",
        "fˈə‍ʊn",
        "fˈiːt",
        "fˈɪŋɡɐ",
        "ˈfɪŋɡɝ",
        "fˈɪʃ",
        "ˈfɪʃ",
        "ˈfit",
        "ˈfɫaʊɝ",
        "ˈfɫaʊɝz",
        "ˈfoʊn",
        "fɹˈɒɡ",
        "ˈfɹɑɡ",
        "fɹˈɒɡz",
        "ˈfɹɑɡz",
        "fˈuːd",
        "ˈfud",
        "fˈʊt",
        "ˈfʊt",
        "ɡˈɑːdən",
        "ɡˈɒn",
        "ˈɡɑɹdən",
        "ˈɡɔn",
        "ɡˈɛt",
        "ˈɡɛt",
        "ˈɡɪt",
        "ɡˈə‍ʊ",
        "ɡˈə‍ʊɪŋ",
        "ɡˈɪv",
        "ˈɡɪv",
        "ˈɡɫəvz",
        "ɡlˈʌvz",
        "ˈɡoʊ",
        "ˈɡoʊɪn",
        "ˈɡoʊɪŋ",
        "ɡɹˈɑːs",
        "ˈɡɹændmɑ",
        "ɡɹˈændmɑː",
        "ˈɡɹændˌpɑ",
        "ɡɹˈændpɑː",
        "ˈɡɹæs",
        "ˈɡʊd",
        "ɡɪd",
        "hˈænd",
        "ˈhænd",
        "hˈændz",
        "ˈhændz",
        "ˈhænz",
        "ˈhæpi",
        "hˈæt",
        "ˈhæt",
        "hˈæts",
        "ˈhæts",
        "hˈɒt",
        "ˈhɑt",
        "ˈhaʊs",
        "hˈɔːs",
        "hˈɔːsɪz",
        "ˈhɔɹs",
        "ˈhɔɹsəz",
        "ˈhɔɹsɪz",
        "hˈɛd",
        "ˈhɛd",
        "hˈe‍ə",
        "ˈhəɡ",
        "həlˈə‍ʊ",
        "həˈɫoʊ",
        "hɛˈɫoʊ",
        "ˈhɛɫp",
        "ˈhɛɫpɪŋ",
        "ˈhɛɫps",
        "ˈhəŋɡɹi",
        "ˈhɛɹ",
        "ˈhəʃ",
        "hˈə‍ʊm",
        "ˈhɪt",
        "hˈɪz",
        "ˈhɪz",
        "hɪz",
        "ˈhoʊm",
        "hˈʌɡ",
        "hˈʌʃ",
        "ˈhwɛɹ",
        "ˈwɛɹ",
        "ˈiːt",
        "ˈiːtɪŋ",
        "ˈi‍ə",
        "ˈi‍əz",
        "ˈɪn",
        "ɪn",
        "ˈɪnˌsaɪd",
        "ˌɪnˈsaɪd",
        "ˈiɹ",
        "ˈɪɹ",
        "ˈiɹz",
        "ˈɪɹz",
        "ˈit",
        "ˈitɪŋ",
        "ˈjəki",
        "ˈjəm",
        "jˈɛs",
        "ˈjɛs",
        "jˈʌki",
        "jˈʌm",
        "kˈɑː",
        "ˈkæɹəts",
        "ˈkɛɹəts",
        "kˈæt",
        "ˈkæt",
        "ˈkɑɹ",
        "kˈɒt",
        "ˈkɑt",
        "kˈa‍ʊ",
        "ˈkaʊ",
        "kˈa‍ʊz",
        "ˈkaʊz",
        "ˈkədəɫ",
        "ˈkədɫɪŋ",
        "kˈe‍əfə‍l",
        "kˈe‍ɪk",
        "ˈkeɪk",
        "kˈe‍ɪks",
        "ˈkeɪks",
        "ˈkəp",
        "ˈkəps",
        "ˈkɛɹfəɫ",
        "kˈə‍ʊt",
        "kˈə‍ʊts",
        "kˈiːz",
        "ˈkɪk",
        "ˈkɪkɪŋ",
        "kˈɪs",
        "ˈkɪs",
        "kˈɪsɪŋ",
        "ˈkɪsɪŋ",
        "kˈɪt‍ʃən",
        "ˈkɪtʃən",
        "ˈkiz",
        "ˈkɫaɪmɪŋ",
        "ˈkɫoʊs",
        "ˈkɫoʊz",
        "ˈkoʊɫd",
        "ˈkoʊt",
        "ˈkoʊts",
        "kɹˈækɐ",
        "ˈkɹækɝ",
        "kɹˈækəz",
        "ˈkɹækɝz",
        "ˈkɹaɪ",
        "ˈkɹaɪɪŋ",
        "ˈkɹeɪˌɑn",
        "ˈkɹɪb",
        "ˈkʊki",
        "kˈʌdə‍l",
        "kˈʌdlɪŋ",
        "kˈʌp",
        "kˈʌps",
        "lˈa‍ɪ‍ən",
        "ˈɫaɪən",
        "lˈa‍ɪ‍ənz",
        "ˈɫaɪənz",
        "lˈa‍ɪt",
        "ˈɫaɪt",
        "lˈɒɹi",
        "ˈɫɔɹi",
        "lˈɛɡ",
        "ˈɫɛɡ",
        "ˈɫəntʃ",
        "lˈʊk",
        "ˈɫʊk",
        "lˈʌnt‍ʃ",
        "ˈmaɪn",
        "ˈmɑmi",
        "ˈmaʊθ",
        "mˈɔː",
        "ˈmɔɹ",
        "ˈməmi",
        "ˈməŋki",
        "ˈməŋkiz",
        "mˈɪlk",
        "ˈmɪɫk",
        "mˈʌmi",
        "mˈʌnki",
        "mˈʌnkɪz",
        "nˈæp",
        "ˈnæp",
        "nˈæpi",
        "nˈə‍ʊz",
        "ˈni",
        "nˈiː",
        "ˈnoʊ",
        "ˈnoʊz",
        "ˈoʊpən",
        "ˈoʊpənɪŋ",
        "pˈɑːk",
        "pˈɑːnts",
        "pˈænke‍ɪk",
        "ˈpænˌkeɪk",
        "ˈpænts",
        "ˈpɑɹk",
        "ˈpɑti",
        "pˈɔ‍ɪnt",
        "ˈpɔɪnt",
        "pəd‍ʒˈɑːməz",
        "pəˈdʒæməz",
        "pəˈdʒɑməz",
        "ˈpɛn",
        "ˈpəpi",
        "pˈɪɡ",
        "ˈpɪɡ",
        "pˈɪɡz",
        "ˈpɪɡz",
        "ˈpɪɫoʊ",
        "plˈe‍ɪ",
        "ˈpɫeɪ",
        "plˈe‍ɪɪŋ",
        "ˈpɫeɪɪŋ",
        "plˈe‍ɪn",
        "ˈpɫeɪn",
        "ˈpɫeɪt",
        "ˈpɫeɪts",
        "plˈiːz",
        "ˈpɫiz",
        "ˈpʊʃ",
        "ˈpʊʃɪŋ",
        "pˈʊʃt‍ʃe‍ə",
        "ˈpʊt",
        "ˈɹæbət",
        "ˈɹæbɪt",
        "ɹˈæbɪt",
        "ˈɹɛd",
        "ˈɹid",
        "ˈɹɛdɪŋ",
        "ˈɹidɪŋ",
        "ɹəˈfɹɪdʒɝˌeɪtɝ",
        "ɹɪˈfɹɪdʒɝˌeɪtɝ",
        "ˈɹən",
        "ˈɹənɪŋ",
        "sˈænd",
        "ˈsænd",
        "sˈɒk",
        "ˈsɑk",
        "sˈɒks",
        "ˈsɑks",
        "ˈʃaʊɝ",
        "ˈseɪ",
        "ˈʃɝt",
        "ˈsi",
        "ʃˈiːp",
        "ˈsɪŋ",
        "ˈsɪŋɪŋ",
        "ˈʃip",
        "ˈsɪɹiəɫ",
        "sˈɪtɪŋ",
        "ˈsɪtɪŋ",
        "slˈa‍ɪd",
        "ˈsɫaɪd",
        "slˈiːp",
        "slˈiːpɪŋ",
        "ˈsɫip",
        "ˈsɫipi",
        "ˈsɫipɪŋ",
        "snˈæk",
        "ˈsnæk",
        "ˈʃoʊ",
        "ˈsoʊp",
        "splˈæʃ",
        "ˈspɫæʃ",
        "splˈæʃɪŋ",
        "ˈspɫæʃɪŋ",
        "spˈuːn",
        "ˈspun",
        "stˈɒp",
        "ˈstɑp",
        "stˈe‍əz",
        "ˈstɛɹz",
        "stɹˈɔːbəɹi",
        "ˈstɹɔˌbɛɹi",
        "ˈstɹoʊɫɝ",
        "ˈʃu",
        "ʃˈuː",
        "ʃˈuːz",
        "ˈʃuz",
        "ˈtɑ",
        "tˈɑː",
        "tˈa‍ɪɡɐ",
        "ˈtaɪɡɝ",
        "tˈa‍ɪɡəz",
        "ˈtaɪɡɝz",
        "ˈtaʊəɫ",
        "ˈtaʊɫ",
        "tˈɔ‍ɪ",
        "ˈtɔɪ",
        "tˈɔ‍ɪz",
        "ˈtɔɪz",
        "tˈe‍ɪbə‍l",
        "ˈteɪbəɫ",
        "ˈtɛɫəˌvɪʒən",
        "tˈɛlɪvˌɪʒən",
        "ˈtəmi",
        "ˈtəŋ",
        "ˈtətʃ",
        "tˈə‍ʊ",
        "tˈə‍ʊst",
        "tˈə‍ʊz",
        "tˈiːθ",
        "tˈɪkə‍l",
        "ˈtɪkəɫ",
        "ˈtiθ",
        "ˈtoʊ",
        "ˈtoʊst",
        "ˈtoʊz",
        "ˈtɹæʃ",
        "tɹˈa‍ʊsəz",
        "ˈtɹaʊzɝz",
        "tɹˈe‍ɪn",
        "ˈtɹeɪn",
        "ˈtɹək",
        "ˈtɹi",
        "tɹˈiː",
        "t‍ʃˈe‍ə",
        "t‍ʃˈe‍əz",
        "ˈtʃɛɹ",
        "ˈtʃɛɹz",
        "t‍ʃˈiːz",
        "ˈtʃiz",
        "tˈuːθ",
        "tˈuːθbɹʌʃ",
        "ˈtuθ",
        "ˈtuθbɹəʃ",
        "tˈʌmi",
        "tˈʌt‍ʃ",
        "vˈækjuːm",
        "ˈvækjum",
        "ˈʌp",
        "ˈwaɪp",
        "ˈwaɪpɪŋ",
        "ˈwɑk",
        "ˈwɔk",
        "wˈɒnt",
        "ˈwɑnt",
        "ˈwɔnt",
        "ˈwɑʃ",
        "ˈwɑʃɪŋ",
        "wˈɔːk",
        "wˈɔːkɪŋ",
        "wˈɔːtɐ",
        "wˈɔːtəɹɪŋ",
        "ˈwɔkɪŋ",
        "ˈwɔtɝ",
        "ˈwɔtɝɪŋ",
        "wˈe‍ɪt",
        "ˈweɪt",
        "ˈwɛt",
        "wˈɪndə‍ʊ",
        "ˈwɪndoʊ",
        "ˈθɝsti",
        "ˈθɹoʊ",
        "ˈθɹoʊɪŋ",
    ];
}
